{% extends 'BASE.html' %}

{% block content %}

<style>
    .container {
        /* background-color: red; */
        margin: 20px auto;
        padding: 0;
    }

    .container-in {
        display: flex;
        height: 266px;
    }

    .d-container {
        width: 25%;
        /* background-color: blue; */
        padding: 0 10px;
    }

    .d-title {
        width: 100%;
        background-color: #333;
        text-align: center;
        border-style: solid;
        border-color: white;
        border-radius: 10px;
        color: white;
    }

    .d-title:hover {
        background-color: white;
        border-style: solid;
        border-color: #333;
        color: #333;
    }

    .d-content {
        /* background-color: cyan; */
        margin: 5px 0;
        display: flex;
        justify-content: space-between;
    }

    .d-content-text {
        padding: auto 0;
    }
</style>

<div class="modal fade modal-delete" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <input type="hidden" id="url-delete">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="deleteModalLabel">Delete Data</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this data ?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <a href="javascript:void(0);" type="submit" class="btn btn-danger btn-block" id="btn-delete">YES</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
    {% include 'modal_create.html' %}
</div>

<div class="container">
    <div class="container-in">
        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                MONDAY
            </button>
            {% for i in monday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
                <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                    TUESDAY
                </button>
            {% for i in tuesday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-id={{i.id}} data-bs-target="#addModal">
                WEDNESDAY
            </button>
            {% for i in wednesday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                THURSDAY
            </button>
            {% for i in thursday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>
    </div>

    
    <div class="container-in">
        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                FRIDAY
            </button>
            {% for i in friday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                SATURDAY
            </button>
            {% for i in saturday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                SUNDAY
            </button>
            {% for i in sunday %}
            <div class="d-content">
                <div class="d-content-text">{{i.title}}</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
            {% endfor %}
        </div>

        <div class="d-container">
            <button type="button" class="btn d-title" data-bs-toggle="modal" data-bs-target="#addModal">
                NOTE
            </button>
            
            <div class="d-content">
                <div class="d-content-text">ISI</div>
                <button type="button" class="gg-remove d-content-delete btn-delete" data-id={{i.id}} data-bs-toggle="modal"
                    data-bs-target="#deleteModal"></button>
            </div>
        </div>
    </div>
</div>

<script>
function Create(){
    let date = $("#InputDate").val();
    let title = $("#InputTitle").val();
    let weight = $("#InputWeight").val();
    let initial = $("#InputInitial").val();
    let target = $("#InputTarget").val();
    $.ajax({
            url: `{% url 'task:create' %}`,
            method: 'post',
            beforeSend: function (xhr) {
                xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
            },
            data: {
                date : date,
                title : title,
                initial : initial,
                target : target,
                weight : weight,
            }
    })
    .done(function(data) {
        console.log('done');
    })
    .fail(function(e) {
        console.log('error');
    });
    $('#addModal').modal('hide');
    $("#formCreateTask")[0].reset();
    window.location.reload();
};
$('body').on('click', '.btn-delete', function() {
    url = `{% url 'task:delete' pk=0 %}`;
    id = $(this).attr('data-id');
    $('#url-delete').val(url.replace("0", id));
    console.log(url);
});

$('#btn-delete').on('click', function() {
    var urlTemp = $('#url-delete').val();
    $.ajax({
        url: urlTemp,
        method: 'post',
        beforeSend: function (xhr) {
            xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
        },
    })
        .done(function(data) {
            $('.modal-delete').modal('hide');
            window.location.reload();
    })
        .fail(function(e) {
            $('.modal-delete').modal('hide');
    }); 
});
</script>

{% endblock %}